<!--
Author: Kaiser
Original Author: Chris
Date last edited: 11/1/2021
-->

<?php
include('connectionData.txt');
$conn = mysqli_connect($server, $user, $pass, $dbname, $port) or die('Error connecting to MySQL server.');
?>

<!DOCTYPE html>
<html lang="en">
  <head>
    <title>CIS 451</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="displayResultsStyle.css" />    
  </head> 
    <body> 
      <section>
      <?php include
      $state = $_POST['state'];
      $state = mysqli_real_escape_string($conn, $state);
      // this is a small attempt to avoid SQL injection
      // better to use prepared statements
      $query = "SELECT DISTINCT firstName, lastName, city FROM customer WHERE state = ";
      $query = $query."'".$state."' ORDER BY 2;";
      ?>
      <p>
      The query:
      </p>
      <?php print $query; ?>
      <p>
      Result of query:
      </p>
      <?php 
      $result = mysqli_query($conn, $query)
      or die(mysqli_error($conn));
      print "<pre>";
      while($row = mysqli_fetch_array($result, MYSQLI_BOTH))
      {
        print "\n";
        print "$row[firstName]  $row[lastName] $row[city]";
      }
      print "</pre>";
      mysqli_free_result($result);
      mysqli_close($conn);
      ?>
      <p> <a href="displayResults.html" >Contents</a>       of the PHP program that created this page. </p>	 
    </section> 
  </body>
</html>
	  